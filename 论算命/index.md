---
title: "论算命与证明之"
date: 2022-04-15
tags: ['随笔', '研究', '算命']
heroImage: "https://images.unsplash.com/photo-1627764574958-fb54cd7d7448?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8ZmF0ZXxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=600&q=60"
comments: false
ShowToc: true
math: true
chart: true
draft: false
---

## 张麻子

自古以来，在百姓眼中，天文与算命紧密相关。吾既然有心研究天文，也不得不写一篇算命的文章。才算成合格的“张麻子”[^1]。至于算命的真实性与否，就如我对世间宗教的看法一般——我原是不信的。不过有些疑惑。或许那是信的，但也难说的很。

## 地摊必读


我判断一本书畅销与否，如今只能去看网上唬人的销售量。在当年，却只需去观察是否能在地摊上见到。仍记得大学时，我就去地摊上找书，净是《费曼物理学讲义》、《电磁学千题解》之流，就知道这必是不凡的读物。同样，当年解读《周易》的书籍可谓汗牛充栋，各种天桥宅巷无处不有，几乎成了“地摊必读”。因此谈算命，不得不提这古代第一“封建迷信”《周易》（或者说《易经》）

我个人不喜“易经”之说法。“易经”之说从本而缪但着实为真。易者，变也。经者，文也。有变则难以成文，有文则难以复变，“易经”之词，岂不自相矛盾呼！

周易来历已不可考，司马迁言文王拘而演《周易》，可见是周公的手笔。又有说早有伏羲做“八卦”，后有炎黄神农《连山易》、《归藏易》云云，不甚明了。但总之，这是孔子之前的上古时期就有的著作。毕竟不语怪力乱神的孔子读易经居然“韦编三绝”，作《十翼》注解，也是一个未解之谜了。

易经注解千千万，我尝试读了一些，大多拖着“封建迷信”的影子，或者是真真顾左右而言它。我认为，这些都受了儒家《十翼》的污染。

在我看来《易》一言以概之曰——“天人合一”。这本是个去预测命运极妙的点子。大体是说，人间的命运与大自然其他事物一样，都遵循同样的发展道理。譬如我不知道我不吃饭会不会饿死，就去观察动物，植物。最终发现，天地万物似乎都需要吃饭，不吃饭的动物结局似乎都不怎么吉利。因此，我们说不吃饭就是凶相。同样的，我们想知道远行凶吉、婚嫁好坏，就去观察类似的动物，乃至天象、水文、气候变化。然后加以对应。

这些对应或许有些瑕疵，这是人类总结自然规律、应用自然规律的开始。这易经本就是一部发展的书，进化的书、需要不断修改完善的书，绝非后世所谓不能质疑的“圣贤书”。在这中心思想下如此发展，恐怕诞生一两个“牛顿”也不为过。只可惜孔子《十翼》将自然规律带向了坟墓——将所有的对应都牵引到道德层面。


综上，《易》的本身用途实在像如今的“历史备考手册”之类，当需要查询一件事的吉凶祸福時，就去找找专家们总结的对应规律。那么算命也理所当然成了不想查手册的人，寻找街边巷口的“活手册”了。前者即如带着课本进开卷考场，后者即如带着老师进了考场。

如本意如我所料，那么后世搞天数占卜、八字筮术岂非误入歧途？下文就以古**揲蓍法**为例，去**证明**这类方法有无道理。



## 揲蓍法

揲蓍法在古代稱為「筮」。筮的由来亦不可考，有说自上古时期同《易》并传，有说为孔子或其学生所做。但这类方法确实多如牛毛。大体的思想史，通过一种方法反复获得“数”，然后用该数对应到《易经》里的一个卦，以该卦的吉凶来指示信命人的祸福。这方法又分两类，一类是不引入先验条件的直接普算，如本文所讨论的揲蓍法。这方法有一个缺点，即如不引入先验条件，算出的结果只能与算命人对应，而不可代人算过（即算法中不包含特定人信息），于是后人发展出了另一种算法，即利用八字生肖等先验信息去算，这里不加累述。以现代观点来看，这类算命法不就是伪随机数生成器么，后者加了种子作为生成条件罢了。

要去证明该算命方法（以下简称算法）是否可信，我们需先做一点假设。

**人类命运大数假设**：每个人的吉凶祸福各不相同，但从全局来看，应当遵循一个平均值在X附近的正态分布。即是说，人类虽然每个人有快乐痛苦不同的命运，但是放在整体上，福人福事与凶人煞事大体有一定数。 

因为算法具有时间不变性（指算法本身不随时间变化），因此其结果概率是不依赖时间的函数。如算法成立，必然要求假设中的X为常数。

《易经》共64卦，384爻。从结果上统计，其中有121爻吉、52爻凶、85爻无咎、4爻何咎、26爻厉，4爻有悔、18爻悔亡、7爻无悔、3爻亨。

去除中性与偏中性的卜辞，吉兆与凶兆的比例约为2.3

{{< chart 100 100 >}}
{
    type: "pie",
    data: {
        labels: ['吉','凶','无咎','爻厉', '悔'],
        datasets: [{
            label: 'Yi',
            data: [121, 52, 85, 26, 18],
            backgroundColor: [
                'rgb(255, 99, 132)',
                'rgb(70, 70, 70)',
                'rgb(255, 205, 86)',
                'rgb(145, 205, 86)',
                'rgb(100, 105, 186)',
            ],
            hoverOffset: 1
        }]
    },
    options: {
        rotation: 250,
    },
}
{{< /chart >}}

《繫辭上》记载的揲蓍法[^2]如下：

> 大衍之數五十，其用四十有九，分而為二以象兩，掛一以象三，揲之以四以象四時，歸奇於扐以象閏，五歲再閏，故再扐而後掛。天數五，地數五，五位相得而各有合。天數二十有五，地數三十，凡天地之數，五十有五，此所以成變化，而行鬼神也。乾之策，二百一十有六。坤之策，百四十有四，凡三百有六十，當期之日。二篇之策，萬有一千五百二十，當萬物之數也，是故，四營而成易，十有八變而成卦，八卦而小成，引而伸之，觸類而長之，天下之能事畢矣。

可以证明（见[附录](#附录)），基于该算法下，获得的卦象概率为：

|      | 阴 | 阳 |
|------|-----|------|
| 少 | 43.75  |  31.25   |
| 老 | 6.25   |  18.75   |

该算法下每一爻阴阳概率为等概率1:1. 总计出现变爻（老阴+老阳）的概率为1/4. 

证明是否正确可以通过模拟检验，我们使用该方法，将结果每一爻记录下来，同时将变爻之数记录下来。结果如下。

基于*一亿次*统计[^3]
|      | 阴 | 阳 |
|------|-----|------|
| 少 | 44128408  | 30298909    |
| 老 | 5895573   | 19677110    |
| 总计 | 50023981   | 49976019    |

{{< chart 100 100 >}}
{
    type: "pie",
    data: {
        labels: ['少阴','老阴','少阳','老阳'],
        datasets: [{
            label: 'Yi',
            data: [44128408, 5895573, 30298909, 19677110],
            backgroundColor: [
                '#b4a992',
                '#806332',
                '#eea2a4',
                '#de1c31',
            ],
            hoverOffset: 1
        }]
    },
    options: {
        rotation: 0,
    },
}
{{< /chart >}}

可以看到，模拟统计结果是符合预测的。

## 对否，错否

从上文统计结果来讲，这算法的结果是等概率的，也即每一爻阴阳都有相同概率出现，那么每一卦都是1/2概率产生的二项分布(Binomial distribution)，在足够多時可演化为正态分布。因此是符合基本假设的。

再来考虑卦象，64卦出现概率是相同的，即易上的每一卦都会被等概率遍历。如果再假设易中吉凶是随机分布的，如此**在不考虑变爻的情况下**，依揲蓍法与易所言，人类全局应该是2.3的吉凶比。

此事正确与否尚难评价。若以不如意事常八九而论，似是凶多吉少；若以福祸相依而论，似是祸福相等；若是以发展而论，似乎是善过于恶。对错与否留给诸公评价吧！


## 附录

下面简单证明揲蓍法算法下的概率.

设一次蓍数为$M$，且令$(M-1)\mod 4 = 0$

> 分而為二以象兩
> 
取任意分割$X$，分为$(X, M-X)$

> 掛一以象三，揲之以四以象四時，歸奇於扐以象閏

从右侧中取一，得$(X, M-X-1)$

再取左侧$X$除以4取余，则该侧剩 $X - \left[ X\mod 4 \right]$

> 五歲再閏，故再扐而後掛。

再取另一侧$M-X$除4取余，则该侧为 $(M-X-1)-[(M-1-X)\mod 4]$

此时揲蓍数为 $N = 1+\left[ (X\mod 4)+((M-X-1)\mod 4) \right]$

先考虑上式括号内，设$x_1 = (X\mod 4)$ 及 $x_2 = (M-X-1)\mod 4)$

易得，在$(M-1)\mod 4=0$即$M\mod 4 = 1$時，有$x_1 + x_2 = 4$

若$X$是范围在(1, M-1)均匀分布的随机变量，此時$x_1$则为取值${0, 1, 2, 3}$的随机变量。

根据揲蓍法规则，当$x_1=0$時，取数4. 定义新变量$x'_1 = \lbrace 4, 1, 2, 3 \rbrace$，同时有$x'_2= \lbrace 4, 3, 2, 1\rbrace $

因此，有$N_0 = N - 1 = \left[ (X\mod 4)+((M-X-1)\mod 4) \right] = \{ 8,4\}$

其中$P(N_0=8)=1/4$, $P(N_0=4)=3/4$

由于$M-1\mod 4=0$，令$M' = M-N = M-N_0-1$则有 $M' \mod 4=3$

重复上述步骤，可以得到，在M'情况下的$N'=1+\left[ (X\mod 4)+((M'-1-X)\mod 4) \right] = \{8,4\}$

其中$P(N=8)=1/2$, $P(N=4)=1/2$

令$M'' = M'-N'$则有 $M'' \mod 4=3$

第三次算法与第二次相同，可得最终结果数为 $M''' = M-1 - N_0 - N' - N''$

其中N_0满足分布$P(N_0=8)=1/4$, $P(N_0=4)=3/4$. $N'$ 与 $N''$独立满足分布$P(N=8)=1/2$, $P(N=4)=1/2$.

综上，可以得到$M'''$满足的分布为：

| $M'''$   | 36   | 32   | 28   | 24   |
|--------|------|------|------|------|
| $M'''/4$ | 9    | 8    | 7    | 6    |
| p      | 3/16 | 7/16 | 5/16 | 1/16 |



[^1]: 电影《让子弹飞》桥段。
[^2]: 揲蓍法是《周易内》记载的唯一方法。
[^3]: 代码见:[Github:imhlq/Trinkets](https://github.com/imhlq/Trinkets/blob/master/SheShi.py)